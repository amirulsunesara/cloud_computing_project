<nav class="navbar navbar-expand-sm navbar-dark bg-primary">
  <a class="navbar-brand" href="#">Broker's Portal</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
    aria-expanded="false" aria-label="Toggle navigation">

    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav mr-auto">
    </ul>
  </div>
</nav>


<form onsubmit="return applicationStatus()" action="javascript:void(0)" ;>
  <fieldset>
    <label>
      <h2>Check Application Status</h2>
    </label>

    <div class="form-group row">

      <div class="col-md-4 mb-3">
        <label>Application Number</label>
        <input type="number" class="form-control" id="appno" name="appno" placeholder="Enter your application number"
          required>
        <div class="invalid-feedback">
        </div>
      </div>
    </div>
    <div class="form-group row">
      <div class="col-md-4 mb-3">
        <label>Password</label>
        <input type="password" class="form-control" id="password" name="password" placeholder="Password" required>
      </div>
    </div>
    </div>

    <div id="appstatus" style="color: green"></div>
    <br>
    <button type="submit" class="btn btn-primary">Submit</button>
    <br>
    <div class="tstyle">
      <table class="table table-dark">
          <thead>
              <tr>
              <th>Applicant Name</th>
              <th>Mortgage ID</th>
              <th>Application Status</th>
              <th>House ID</th>
              <th>Insured Amount</th>
              <th>Deductible Amount</th>
              </tr>
          </thead>
          <tbody id='tableBody'>
          </tbody>
      </table>
    </div>
  </fieldset>
</form>

<script type="text/javascript">
  function applicationStatus() {
    console.log("Inside Function");

    var appno = document.getElementById("appno").value;
    var pass = document.getElementById("password").value;


    $.ajax({
      type: "POST",
      url: "http://localhost:1337/getStatus",
      data: JSON.stringify({ "AppNo": appno, "Password": pass }),
      dataType: "json",
      contentType: "application/json",
      crossDomain: true,
      async: false,
      success: function (Broker) {

        if(Broker["Message"] == "Wrong Password"){
          alert("Invalid Password");
        } else if(Broker["Message"] == "Wrong Application Number"){
          alert("Invalid Application Number");
        } else {
        if(Broker.insured_amount == 0){
          var iamount="N/A";
          
        } else {
          iamount = Broker.insured_amount;  
        }

        if( Broker.deductible_amount == 0){
          var damount = "N/A";
        }
        else {
          damount = Broker.deductible_amount;
        }
          htmlRow = '<tr><td>'+Broker.emp_name+'</td><td>'+Broker.id+'</td><td>'+Broker.applicationStatus+'</td><td>'+Broker.house_id+'</td><td>'+iamount+'</td><td>'+damount+'</td>';
              $("#tableBody").html(htmlRow);
      
      }
      }
    });

  }
</script>